{
   "Identifier":"VR-MT-0010",
   "Type":"Acceptance",
   "Country":"MT",
   "Version":"1.0.0",
   "SchemaVersion":"1.0.0",
   "Engine":"CERTLOGIC",
   "EngineVersion":"0.7.5",
   "CertificateType":"Vaccination",
   "Description":[
      {
         "lang":"en",
         "desc":"Verification Datetime must be less than 90 days after vaccination of 2nd dose for age >18"
      }
   ],
   "ValidFrom":"2022-01-17T00:00:00Z",
   "ValidTo":"2030-06-01T00:00:00Z",
   "AffectedFields":[
      "dob",
      "v.0.dn",
      "v.0.sd",
      "v.0.dt"
   ],
   "Logic":{
      "if":[
         {
            "var":"payload.v.0"
         },
         {
            "var":"payload.dob"
         },
         {
            "if":[
               {
                  "after":[
                     {
                        "plusTime":[
                           {
                              "var":"external.validationClock"
                           },
                           0,
                           "day"
                        ]
                     },
                     {
                        "plusTime":[
                           {
                              "var":"payload.dob"
                           },
                           5844,
                           "day"
                        ]
                     }
                  ]
               },
               {
                  "if":[
                     {
                        "===":[
                           {
                              "var":"payload.v.0.sd"
                           },
                           2
                        ]
                     },
                     {
                        "if":[
                           {
                              "===":[
                                 {
                                    "var":"payload.v.0.dn"
                                 },
                                 {
                                    "var":"payload.v.0.sd"
                                 }
                              ]
                           },
                           {
                              "not-after":[
                                 {
                                    "plusTime":[
                                       {
                                          "var":"payload.v.0.dt"
                                       },
                                       0,
                                       "day"
                                    ]
                                 },
                                 {
                                    "plusTime":[
                                       {
                                          "var":"external.validationClock"
                                       },
                                       0,
                                       "day"
                                    ]
                                 },
                                 {
                                    "plusTime":[
                                       {
                                          "var":"payload.v.0.dt"
                                       },
                                       90,
                                       "day"
                                    ]
                                 }
                              ]
                           },
                           true
                        ]
                     },
                     true
                  ]
               },
               true
            ]
         }
      ]
   }
}